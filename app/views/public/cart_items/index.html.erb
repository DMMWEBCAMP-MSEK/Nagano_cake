<div class="container">
<div>


<div class="h5 m-4 float-left bg-secondary text-light">  ショッピングカート  </div>

<% if current_customer.cart_items.present? %>

<div class="m-4 float-right">
  <%= link_to "カートを空にする", destroy_all_cart_items_path, method: :delete, class: "btn btn-danger" %>
</div>

<div>
  <table class="table table-bordered">
    <thead class="thead-dark">
        <th>商品名</th>
        <th>単価(税込)</th>
        <th>数量</th>
        <th>小計</th>
        <th></th>
    </thead>
    <% @cart_items.each do |cart_item| %>
      <tbody>
          <tr>
            <td>
              <%= image_tag cart_item.item.image, size: "50x50" %>
              <%= cart_item.item.name %>
            </td>
            <td class="align-middle">
              <%= cart_item.item.with_tax_price.to_s(:delimited) %>
            </td>
            <td>
              <%= form_with model: cart_item, url: cart_item_path(cart_item), local: true, method: :patch do |f| %>
              <%= f.number_field :amount, min: 1, max:10, id: "amount_cart",class: "m-2" %>
              <%= f.submit "変更",class: "m-2 btn btn-success" %>
              <% end %>
            </td>
            <td class="align-middle">
              <%= cart_item.subtotal.to_s(:delimited) %>
            </td>
            <td>
              <%= link_to "削除する", cart_item_path(cart_item.id), method: :delete, class: "mt-2 d-flex justify-content-center btn btn-sm btn-danger" %>
            </td>
          </tr>
      </tbody>
    <% end %>
  </table>
</div>

<% end %>

<div class="row">
<div class="container">
  <%= link_to '買い物を続ける', root_path, class: "mt-4 btn btn-primary" %>

  <% if current_customer.cart_items.present? %>

  <div class="float-right">
    <table class="table table-bordered">
      <thead class="thead-dark">
        <tr>
         <th>
          合計金額
         </th>
         <td>
          <%= @total.to_s(:delimited) %>
         </td>
        </tr>
      </thead>
    </table>
  </div>

  <% end %>

</div>
</div>

<% if current_customer.cart_items.present? %>

<%= form_with model: @order, url: new_order_path(@order), method: :get, local:true do |f| %>
  <div class="field col-sm-12 text-center mt-2">
    <%= f.submit "情報入力へ進む", class: "btn btn-success" %>
  </div>
<% end %>

<% end %>

</div>
</div>